#! /usr/bin/env nix-shell
#! nix-shell -p uv cacert git dialog --pure
#! nix-shell -i 'uv run --with git+https://github.com/ihucos/siesta.git --no-project siesta' 

{% set commit|dedent|prompt("ollama/qwen3:4b")|striptags %}
  Craft a very short commit message based on this diff:
  ```
  {{ "git diff --cached --unified=0 | grep -v '^@' || true"|run
      or error("No staged changes") }}
  ```
  /no_think
{% endset %}

{% filter run %}
  git commit -am {{ commit.splitlines()|first|askedit|escape }}
{% endfilter %}
